# Run unit tests (GitHub action)

name: unit tests

on: [push, pull_request]

permissions:
    contents: read

jobs:

  unit-tests-Ubuntu-jdk-17:

    runs-on: ubuntu-latest

    steps:
      - run: echo "Branch ${{ github.ref }} of repository ${{ github.repository }}."

      - uses: actions/checkout@v3
      - uses: gradle/wrapper-validation-action@v1

      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          distribution: 'temurin'
          java-version: '17'

      - name: Set up Python 3.11
        uses: actions/setup-python@v4
        with:
          # This has to match the language version we're targeting
          python-version: '3.11'

      - name: Unit test with Gradle
        run: ./gradlew --no-daemon test

      - name: Clean up Gradle cache
        # Remove some files from the Gradle cache, so they aren't cached
        # by GitHub Actions. Restoring these files from a GitHub Actions
        # cache might cause problems for future builds.
        #https://docs.github.com/en/actions/guides/building-and-testing-java-with-gradle#caching-dependencies
        run: |
          rm -f ~/.gradle/caches/modules-2/modules-2.lock
          rm -f ~/.gradle/caches/modules-2/gc.properties
